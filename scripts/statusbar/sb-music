#!/bin/sh
# Music (mpd) — status2d purple (#d3869b)

filter() { sed "/^volume:/d;s/\\[paused\\].*/󰏤/g;/\\[playing\\].*/d;/^ERROR/Q" | paste -sd ' ' -;}

pidof -x sb-mpdup >/dev/null 2>&1 || sb-mpdup >/dev/null 2>&1 &
btn="${BUTTON:-${BLOCK_BUTTON:-0}}"

case "$btn" in
	1) mpc status | filter ; setsid -f "$TERMINAL" -e ncmpcpp ;;
	2) mpc toggle | filter ;;
	3) mpc status | filter ; notify-send "󰝚 Music" "Shows mpd track.\n󰏤 when paused.\nClick: ncmpcpp\nMiddle: pause\nScroll: prev/next" ;;
	4) mpc prev   | filter ;;
	5) mpc next   | filter ;;
	6) mpc status | filter ; setsid -f "$TERMINAL" -e "$EDITOR" "$0" ;;
	*) printf "^c#d3869b^󰝚 %s^d^" "$(mpc status | filter)" ;;
esac
